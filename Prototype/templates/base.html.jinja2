<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>

    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous"/>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@firstandthird/tokens@latest/lib/tokens.css"/>

    {% block title %}
        <title>Default title</title>
    {% endblock %}

</head>

<body>

<nav class="navbar navbar-expand">
    <div class="container justify-content-between" id="navbarCenterContent">
        <a class="navbar-brand" href="/"><img class="logo" src="../static/pictures/logo.png" alt="Protogram"></a>
        <div class="navbar-nav">
            <a class="nav-item nav-link" href="{{ url_for('feed.feed_index') }}"><i
                    class="nav-icon bi bi-house"></i></a>
            <a class="nav-item nav-link" href="{{ url_for('profile.profile_index') }}"><i
                    class="nav-icon bi bi-person-circle"></i></a>
            <a class="nav-item nav-link" href="{{ url_for('follow.follow_index') }}"><i
                    class="nav-icon bi bi-people"></i></a>
            <a class="nav-item nav-link" href="{{ url_for('search_post.search') }}"><i
                    class="nav-icon bi bi-search"></i></a>
            {#            <form class="d-flex">#}
            {#                <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">#}
            {#                <a class="btn btn-outline-success" href="{{ url_for('search_post.search') }}" type="button">#}
            {#                    Search#}
            {#                </a>#}
            {#            </form>#}
        </div>
        <button id="themeSwitch"><i class="bi bi-brightness-high"></i></button>
    </div>
</nav>

<!-- This script comes here to load the correct theme (light or dark) at the beginning -->
<script src="../static/scripts/scripts.js"></script>

{% block content %}

{% endblock %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>

<script>
    /* Script for "hearting" a post */
    function heart_post(post_id) {
        $.ajax({
            url: '/post/heart/' + post_id,
            type: 'POST',
            dataType: 'json',
            success: function (updated_post) {
                // We use the post card id again, to reload this one only
                let post_card_id = 'post_card_' + post_id;
                $('#' + post_card_id).replaceWith(updated_post);
            }
        })
    }

    function follow_user(user_id) {
        $.ajax({
            url: '/follow/' + user_id,
            type: 'POST',
            dataType: 'json',
            success: function (updated_user_tile) {
                // We rerender the user tile to update the "Follow button" appearance
                $('#user_tile_' + user_id).replaceWith(updated_user_tile);
            }
        })
    }

    function add_comment(post_id, id) {
        $.ajax({
            url: '/create_comment/add_comment',
            type: 'POST',
            dataType: 'json',
            contentType: "application/json",
            data: JSON.stringify({
                "body": $("#body" + id).val(),
                "post_id": post_id,
            })
            ,
            success: function () {
                window.location.href = "/";
            }
        })
    }

    function add_post(user_id, username) {
        $.ajax({
            url: '/create_post/',
            type: 'POST',
            dataType: 'json',
            contentType: "application/json",
            data: JSON.stringify({
                "description": $("#description").val(),
                "id": user_id,
                "username": username,
            })
            ,
            success: function () {
                window.location.href = "/profile";
            }
        })
    }

    function del_post(post_id) {
        if (confirm("Voulez-vous vraiment supprimer ce post ?")) {
            $.ajax({
                url: '/create_post/del_post',
                type: 'DELETE',
                dataType: 'json',
                contentType: "application/json",
                data: JSON.stringify({
                    "id": post_id,
                }),
                success: function () {
                    window.location.href = "/profile";
                }
            })

        }

    }
</script>

</body>
</html>